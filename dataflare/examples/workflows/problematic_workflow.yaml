# 有问题的工作流示例
id: problematic-workflow
name: Problematic Workflow
description: 包含各种问题的工作流示例，用于测试验证功能
version: 1.0.0

# 数据源配置
sources:
  # 正常源
  users:
    type: postgres
    config:
      host: localhost
      port: 5432
      database: testdb
      username: postgres
      password: postgres
      table: users
  
  # 未连接的源
  products:
    type: postgres
    config:
      host: localhost
      port: 5432
      database: testdb
      username: postgres
      password: postgres
      table: products
  
  # 孤立的源
  isolated_source:
    type: memory
    config:
      data: []

# 转换配置
transformations:
  # 正常转换
  user_transform:
    inputs:
      - users
    type: mapping
    config:
      mappings:
        - source: name
          destination: user.name
        - source: email
          destination: user.email
  
  # 循环依赖 1
  transform_a:
    inputs:
      - transform_b
    type: mapping
    config:
      mappings:
        - source: "*"
          destination: "*"
  
  # 循环依赖 2
  transform_b:
    inputs:
      - transform_a
    type: mapping
    config:
      mappings:
        - source: "*"
          destination: "*"
  
  # 悬空组件
  dangling_transform:
    inputs:
      - users
    type: filter
    config:
      condition: "active == true"
  
  # 无效输入
  invalid_input_transform:
    inputs:
      - non_existent_source
    type: mapping
    config:
      mappings:
        - source: "*"
          destination: "*"

# 目标配置
destinations:
  # 正常目标
  es_users:
    inputs:
      - user_transform
    type: elasticsearch
    config:
      host: localhost
      port: 9200
      index: users
  
  # 无效输入目标
  invalid_dest:
    inputs:
      - non_existent_transform
    type: memory
    config: {}
